generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url    = env("DATABASE_URL")
}

model User {
  id        String    @id @default(uuid()) @db.Char(36)
  name      String    @db.VarChar(255)
  email     String    @unique @db.VarChar(255)
  password  String    @db.VarChar(255)
  city      String?   @db.VarChar(100)
  estate    String?   @db.VarChar(2)
  country   String?   @db.VarChar(100)
  birthDate DateTime? @db.Date
  registeredWhen DateTime  @default(now()) @db.Timestamp(0)
  updatedWhen   DateTime  @default(now()) @updatedAt @db.Timestamp(0)

  applicationsCreated Application[] @relation("UserApplicationsCreated")
  applicationsUpdated Application[] @relation("UserApplicationsUpdated")

  userApplications UserApplication[]

  @@map("user")
}
model Application {
  id          String   @id @default(uuid())
  name        String   @db.VarChar(50)
  description String   @db.VarChar(255)
  created     DateTime @default(now())
  updated     DateTime @updatedAt
  createdById String
  updatedById String

  createdBy User @relation("UserApplicationsCreated", fields: [createdById], references: [id])
  updatedBy User @relation("UserApplicationsUpdated", fields: [updatedById], references: [id])

  userApplications UserApplication[]

  @@map("application")
}

model UserApplication {
  userId        String
  applicationId String
  addedAt       DateTime @default(now())

  user          User        @relation(fields: [userId], references: [id])
  application   Application @relation(fields: [applicationId], references: [id])

  @@id([userId, applicationId])
  @@map("user_application")
}
